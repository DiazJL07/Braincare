<%- include('../partials/header') %>
<link rel="stylesheet" href="/css/guide-detail.css">
<div class="guide-detail-container">
  <div class="container mt-4">
    <div class="guide-layout-row">
      <!-- Información principal de la guía -->
      <div class="guide-main-content">
        <div class="guide-main-card">
          <% if (guide.image) { %>
            <img src="<%= guide.image %>" class="guide-detail-image" alt="<%= guide.title %>">
          <% } %>
          <div class="guide-detail-body">
            <h1 class="guide-detail-title"><%= guide.title %></h1>
            <div class="guide-detail-meta">
              <span class="guide-detail-badge"><%= guide.topic %></span>
              <div class="guide-detail-stats">
                <span><i class="fas fa-eye"></i> <%= guide.views %> vistas</span>
                <span><i class="fas fa-download"></i> <%= guide.downloads %> descargas</span>
              </div>
            </div>
            <div class="guide-detail-author-info">
              <small>
                <strong>Por:</strong> <%= guide.author ? guide.author.name : 'Autor desconocido' %><br>
                <strong>Publicado:</strong> <%= new Date(guide.publicationDate).toLocaleDateString() %>
              </small>
            </div>
          
            <!-- Botón de descarga -->
            <a href="/guides/<%= guide._id %>/download" class="guide-detail-btn">
              <i class="fas fa-download"></i>
              <span>Descargar Guía</span>
            </a>
          </div>
        </div>
      </div>
    
      <!-- Sidebar con información adicional -->
      <div class="guide-sidebar-content">
        <div class="guide-sidebar-card">
          <div class="card-body">
            <h5 class="card-title">Sobre el autor</h5>
            <p class="card-text">
              Esta guía fue elaborada por <%= guide.author ? guide.author.name : 'Autor desconocido' %>, 
              profesional en salud mental de BrainCare.
            </p>
          </div>
        </div>
        
        <div class="guide-sidebar-card">
          <div class="card-body">
            <h5 class="card-title">Temas relacionados</h5>
            <div class="d-grid gap-2">
              <a href="/guides?topic=<%= guide.topic %>" class="guide-detail-btn-outline">
                <i class="fas fa-tag"></i>
                Ver más sobre <%= guide.topic %>
              </a>
              <a href="/guides" class="guide-detail-btn-outline">
                <i class="fas fa-list"></i>
                Ver todas las guías
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Visor de PDF -->
    <div class="guide-pdf-section">
      <div class="guide-pdf-card">
        <div class="guide-pdf-header">
          <h5 class="mb-0">Vista previa de la guía</h5>
        </div>
        <div class="guide-pdf-viewer">
          <div class="guide-pdf-container">
            <iframe src="<%= guide.pdfFile %>" title="<%= guide.title %>" class="guide-pdf-iframe" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <!-- Tu JS primero, para que el callback global exista antes de cargar el script de Google -->
  <script src="/js/tradux.js"></script>
  <!-- Script oficial de Google (callback definido en translate.js) -->
  <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<%- include('../partials/footer') %>